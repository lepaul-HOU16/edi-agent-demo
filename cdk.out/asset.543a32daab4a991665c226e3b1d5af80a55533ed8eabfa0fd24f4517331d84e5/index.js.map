{
  "version": 3,
  "sources": ["../../../lambda-functions/projects/handler.ts", "../../../lambda-functions/shared/types.ts"],
  "sourcesContent": ["/**\n * Project Management Lambda Function\n * \n * Handles renewable energy project operations:\n * - Delete project and all S3 artifacts\n * - Rename project\n * - Export project\n * - Get project details\n */\n\nimport { APIGatewayProxyEventV2, APIGatewayProxyResultV2 } from 'aws-lambda';\nimport { S3Client, ListObjectsV2Command, DeleteObjectsCommand, GetObjectCommand } from '@aws-sdk/client-s3';\nimport { DynamoDBClient, ScanCommand, UpdateItemCommand, DeleteItemCommand } from '@aws-sdk/client-dynamodb';\nimport {\n  getUserContext,\n  successResponse,\n  errorResponse,\n  parseBody,\n  validateRequired,\n} from '../shared/types';\n\nconst s3Client = new S3Client({});\nconst dynamoClient = new DynamoDBClient({});\nconst bucketName = process.env.STORAGE_BUCKET || '';\nconst sessionContextTable = process.env.SESSION_CONTEXT_TABLE || 'RenewableSessionContext';\nconst agentProgressTable = process.env.AGENT_PROGRESS_TABLE || 'AgentProgress';\n\n/**\n * Delete renewable project and all S3 artifacts AND DynamoDB references\n */\nasync function deleteProject(projectId: string, userId: string): Promise<any> {\n  console.log(`\uD83D\uDDD1\uFE0F  COMPREHENSIVE DELETE: ${projectId} for user: ${userId}`);\n\n  if (!bucketName) {\n    throw new Error('Storage bucket not configured');\n  }\n\n  const deletionSummary = {\n    projectId,\n    s3FilesDeleted: 0,\n    sessionContextUpdates: 0,\n    agentProgressDeleted: 0,\n    errors: [] as string[],\n  };\n\n  try {\n    // ============================================\n    // STEP 1: Delete S3 Artifacts\n    // ============================================\n    console.log('\uD83D\uDCE6 Step 1: Deleting S3 artifacts...');\n    \n    // Delete all artifact files in the project directory (renewable/{projectId}/*)\n    const projectPrefix = `renewable/${projectId}/`;\n    console.log(`   Listing objects with prefix: ${projectPrefix}`);\n\n    const listCommand = new ListObjectsV2Command({\n      Bucket: bucketName,\n      Prefix: projectPrefix,\n    });\n\n    const listResponse = await s3Client.send(listCommand);\n\n    if (listResponse.Contents && listResponse.Contents.length > 0) {\n      console.log(`   Found ${listResponse.Contents.length} objects to delete`);\n\n      // Delete all objects in batch\n      const deleteCommand = new DeleteObjectsCommand({\n        Bucket: bucketName,\n        Delete: {\n          Objects: listResponse.Contents.map((obj) => ({ Key: obj.Key! })),\n        },\n      });\n\n      await s3Client.send(deleteCommand);\n      deletionSummary.s3FilesDeleted += listResponse.Contents.length;\n      console.log(`   \u2705 Deleted ${deletionSummary.s3FilesDeleted} artifact files`);\n    } else {\n      console.log(`   \u2139\uFE0F  No artifacts found in S3`);\n    }\n\n    // Delete project metadata file\n    const projectMetadataKey = `renewable/projects/${projectId}/project.json`;\n    try {\n      const deleteMetadataCommand = new DeleteObjectsCommand({\n        Bucket: bucketName,\n        Delete: {\n          Objects: [{ Key: projectMetadataKey }],\n        },\n      });\n      await s3Client.send(deleteMetadataCommand);\n      deletionSummary.s3FilesDeleted++;\n      console.log(`   \u2705 Deleted project metadata: ${projectMetadataKey}`);\n    } catch (error) {\n      console.warn(`   \u26A0\uFE0F  Project metadata not found: ${projectMetadataKey}`);\n    }\n\n    // ============================================\n    // STEP 2: Clean SessionContext Table\n    // ============================================\n    console.log('\uD83D\uDCCB Step 2: Cleaning SessionContext table...');\n    \n    try {\n      // Scan for all sessions that reference this project\n      const scanCommand = new ScanCommand({\n        TableName: sessionContextTable,\n        FilterExpression: 'contains(project_history, :projectId) OR active_project = :projectId',\n        ExpressionAttributeValues: {\n          ':projectId': { S: projectId },\n        },\n      });\n\n      const scanResponse = await dynamoClient.send(scanCommand);\n\n      if (scanResponse.Items && scanResponse.Items.length > 0) {\n        console.log(`   Found ${scanResponse.Items.length} sessions referencing project`);\n\n        // Update each session to remove project references\n        for (const item of scanResponse.Items) {\n          const sessionId = item.session_id.S!;\n          \n          try {\n            // Get current project_history\n            const projectHistory = item.project_history?.L || [];\n            const filteredHistory = projectHistory\n              .filter((p: any) => p.S !== projectId)\n              .map((p: any) => p.S);\n\n            // Update the session\n            const updateCommand = new UpdateItemCommand({\n              TableName: sessionContextTable,\n              Key: {\n                session_id: { S: sessionId },\n              },\n              UpdateExpression: 'SET project_history = :history, last_updated = :timestamp REMOVE active_project',\n              ExpressionAttributeValues: {\n                ':history': { L: filteredHistory.map((p: string) => ({ S: p })) },\n                ':timestamp': { S: new Date().toISOString() },\n              },\n            });\n\n            await dynamoClient.send(updateCommand);\n            deletionSummary.sessionContextUpdates++;\n            console.log(`   \u2705 Updated session: ${sessionId}`);\n          } catch (error: any) {\n            console.error(`   \u274C Failed to update session ${sessionId}:`, error.message);\n            deletionSummary.errors.push(`Session ${sessionId}: ${error.message}`);\n          }\n        }\n\n        console.log(`   \u2705 Updated ${deletionSummary.sessionContextUpdates} sessions`);\n      } else {\n        console.log(`   \u2139\uFE0F  No sessions found referencing this project`);\n      }\n    } catch (error: any) {\n      console.error(`   \u274C Error scanning SessionContext:`, error.message);\n      deletionSummary.errors.push(`SessionContext scan: ${error.message}`);\n    }\n\n    // ============================================\n    // STEP 3: Clean AgentProgress Table\n    // ============================================\n    console.log('\u2699\uFE0F  Step 3: Cleaning AgentProgress table...');\n    \n    try {\n      // Scan for agent progress entries related to this project\n      const scanProgressCommand = new ScanCommand({\n        TableName: agentProgressTable,\n        FilterExpression: 'contains(#data, :projectId)',\n        ExpressionAttributeNames: {\n          '#data': 'data',\n        },\n        ExpressionAttributeValues: {\n          ':projectId': { S: projectId },\n        },\n      });\n\n      const progressResponse = await dynamoClient.send(scanProgressCommand);\n\n      if (progressResponse.Items && progressResponse.Items.length > 0) {\n        console.log(`   Found ${progressResponse.Items.length} agent progress entries`);\n\n        // Delete each progress entry\n        for (const item of progressResponse.Items) {\n          const requestId = item.requestId.S!;\n          \n          try {\n            const deleteProgressCommand = new DeleteItemCommand({\n              TableName: agentProgressTable,\n              Key: {\n                requestId: { S: requestId },\n              },\n            });\n\n            await dynamoClient.send(deleteProgressCommand);\n            deletionSummary.agentProgressDeleted++;\n            console.log(`   \u2705 Deleted progress entry: ${requestId}`);\n          } catch (error: any) {\n            console.error(`   \u274C Failed to delete progress ${requestId}:`, error.message);\n            deletionSummary.errors.push(`AgentProgress ${requestId}: ${error.message}`);\n          }\n        }\n\n        console.log(`   \u2705 Deleted ${deletionSummary.agentProgressDeleted} progress entries`);\n      } else {\n        console.log(`   \u2139\uFE0F  No agent progress entries found`);\n      }\n    } catch (error: any) {\n      console.error(`   \u274C Error scanning AgentProgress:`, error.message);\n      deletionSummary.errors.push(`AgentProgress scan: ${error.message}`);\n    }\n\n    // ============================================\n    // SUMMARY\n    // ============================================\n    console.log('\\n\u2705 DELETION COMPLETE');\n    console.log('\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550');\n    console.log(`Project ID: ${projectId}`);\n    console.log(`S3 Files Deleted: ${deletionSummary.s3FilesDeleted}`);\n    console.log(`Session Contexts Updated: ${deletionSummary.sessionContextUpdates}`);\n    console.log(`Agent Progress Deleted: ${deletionSummary.agentProgressDeleted}`);\n    console.log(`Errors: ${deletionSummary.errors.length}`);\n    console.log('\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\\n');\n\n    return {\n      ...deletionSummary,\n      success: true,\n      message: `Successfully deleted project ${projectId} from all systems`,\n    };\n  } catch (error: any) {\n    console.error('\u274C CRITICAL ERROR during deletion:', error);\n    throw new Error(`Failed to delete project: ${error.message}`);\n  }\n}\n\n/**\n * Rename renewable project\n */\nasync function renameProject(projectId: string, newName: string, userId: string): Promise<any> {\n  console.log(`Renaming project ${projectId} to ${newName} for user: ${userId}`);\n\n  if (!bucketName) {\n    throw new Error('Storage bucket not configured');\n  }\n\n  try {\n    // Get current project metadata\n    const projectMetadataKey = `renewable/projects/${projectId}/project.json`;\n    const getCommand = new GetObjectCommand({\n      Bucket: bucketName,\n      Key: projectMetadataKey,\n    });\n\n    let projectData: any = {};\n\n    try {\n      const response = await s3Client.send(getCommand);\n      const body = await response.Body?.transformToString();\n      if (body) {\n        projectData = JSON.parse(body);\n      }\n    } catch (error) {\n      console.warn(`Project metadata not found, creating new: ${projectMetadataKey}`);\n    }\n\n    // Update project name\n    projectData.project_name = newName;\n    projectData.updated_at = new Date().toISOString();\n\n    // Save updated metadata\n    const { PutObjectCommand } = await import('@aws-sdk/client-s3');\n    const putCommand = new PutObjectCommand({\n      Bucket: bucketName,\n      Key: projectMetadataKey,\n      Body: JSON.stringify(projectData, null, 2),\n      ContentType: 'application/json',\n    });\n\n    await s3Client.send(putCommand);\n\n    console.log(`Successfully renamed project ${projectId} to ${newName}`);\n\n    return {\n      projectId,\n      newName,\n      message: `Project renamed to ${newName}`,\n    };\n  } catch (error: any) {\n    console.error('Error renaming project:', error);\n    throw new Error(`Failed to rename project: ${error.message}`);\n  }\n}\n\n/**\n * Get renewable project details\n */\nasync function getProjectDetails(projectId: string, userId: string): Promise<any> {\n  console.log(`Getting details for project: ${projectId} for user: ${userId}`);\n\n  if (!bucketName) {\n    throw new Error('Storage bucket not configured');\n  }\n\n  try {\n    // List all objects for this project\n    const prefix = `renewable/${projectId}/`;\n    const listCommand = new ListObjectsV2Command({\n      Bucket: bucketName,\n      Prefix: prefix,\n    });\n\n    const listResponse = await s3Client.send(listCommand);\n\n    if (!listResponse.Contents || listResponse.Contents.length === 0) {\n      throw new Error(`Project ${projectId} not found`);\n    }\n\n    // Organize artifacts by type\n    const artifacts = listResponse.Contents.map((obj) => ({\n      key: obj.Key,\n      size: obj.Size,\n      lastModified: obj.LastModified,\n      url: `https://${bucketName}.s3.amazonaws.com/${obj.Key}`,\n    }));\n\n    // Determine completion status based on artifacts\n    const hasTerrain = artifacts.some((a) => a.key?.includes('/terrain/'));\n    const hasLayout = artifacts.some((a) => a.key?.includes('/layout/'));\n    const hasSimulation = artifacts.some((a) => a.key?.includes('/simulation/'));\n    const hasReport = artifacts.some((a) => a.key?.includes('/report/'));\n\n    let completionStatus = 'incomplete';\n    if (hasTerrain && hasLayout && hasSimulation && hasReport) {\n      completionStatus = 'complete';\n    } else if (hasTerrain || hasLayout) {\n      completionStatus = 'in_progress';\n    }\n\n    // Try to get project metadata\n    let projectName = projectId;\n    try {\n      const projectMetadataKey = `renewable/projects/${projectId}/project.json`;\n      const getCommand = new GetObjectCommand({\n        Bucket: bucketName,\n        Key: projectMetadataKey,\n      });\n      const response = await s3Client.send(getCommand);\n      const body = await response.Body?.transformToString();\n      if (body) {\n        const metadata = JSON.parse(body);\n        projectName = metadata.project_name || projectId;\n      }\n    } catch (error) {\n      console.warn(`Project metadata not found: ${projectId}`);\n    }\n\n    return {\n      projectId,\n      projectName,\n      artifacts,\n      metadata: {\n        totalFiles: artifacts.length,\n        hasTerrain,\n        hasLayout,\n        hasSimulation,\n        hasReport,\n      },\n      completionStatus,\n      createdAt: artifacts[0]?.lastModified,\n      updatedAt: artifacts[artifacts.length - 1]?.lastModified,\n    };\n  } catch (error: any) {\n    console.error('Error getting project details:', error);\n    throw new Error(`Failed to get project details: ${error.message}`);\n  }\n}\n\n/**\n * Lambda handler\n */\nexport const handler = async (event: APIGatewayProxyEventV2): Promise<APIGatewayProxyResultV2> => {\n  console.log('Projects Lambda invoked:', JSON.stringify(event, null, 2));\n\n  try {\n    // Get user context from JWT\n    const user = getUserContext(event);\n    if (!user) {\n      return errorResponse('Unauthorized', 'UNAUTHORIZED', 401);\n    }\n\n    // Determine operation from path\n    const path = event.requestContext.http.path;\n    const method = event.requestContext.http.method;\n\n    // POST /api/projects/delete\n    if (path === '/api/projects/delete' && method === 'POST') {\n      const body = parseBody<{ projectId: string }>(event);\n      const validationError = validateRequired(body, ['projectId']);\n      if (validationError) {\n        return errorResponse(validationError, 'INVALID_INPUT', 400);\n      }\n\n      const result = await deleteProject(body!.projectId, user.sub);\n      return successResponse(result, 'Project deleted successfully');\n    }\n\n    // POST /api/projects/rename\n    if (path === '/api/projects/rename' && method === 'POST') {\n      const body = parseBody<{ projectId: string; newName: string }>(event);\n      const validationError = validateRequired(body, ['projectId', 'newName']);\n      if (validationError) {\n        return errorResponse(validationError, 'INVALID_INPUT', 400);\n      }\n\n      const result = await renameProject(body!.projectId, body!.newName, user.sub);\n      return successResponse(result, 'Project renamed successfully');\n    }\n\n    // GET /api/projects/{projectId}\n    if (path.startsWith('/api/projects/') && method === 'GET') {\n      const projectId = path.split('/').pop();\n      if (!projectId) {\n        return errorResponse('Project ID is required', 'INVALID_INPUT', 400);\n      }\n\n      const result = await getProjectDetails(projectId, user.sub);\n      return successResponse(result);\n    }\n\n    // Unknown route\n    return errorResponse('Not found', 'NOT_FOUND', 404);\n  } catch (error: any) {\n    console.error('Error in projects handler:', error);\n    return errorResponse(error.message || 'Internal server error', 'INTERNAL_ERROR', 500);\n  }\n};\n", "/**\n * Shared TypeScript types for Lambda functions\n */\n\nimport { APIGatewayProxyEventV2, APIGatewayProxyResultV2 } from 'aws-lambda';\n\n/**\n * Standard API response format\n */\nexport interface ApiResponse<T = any> {\n  success: boolean;\n  message?: string;\n  data?: T;\n  error?: string;\n  code?: string;\n}\n\n/**\n * User context from JWT token\n */\nexport interface UserContext {\n  sub: string; // User ID\n  email?: string;\n  username?: string;\n  groups?: string[];\n}\n\n/**\n * Extract user context from API Gateway event\n */\nexport function getUserContext(event: APIGatewayProxyEventV2): UserContext | null {\n  try {\n    const authorizer = (event.requestContext as any).authorizer;\n    const claims = authorizer?.jwt?.claims;\n\n    if (!claims) {\n      return null;\n    }\n\n    return {\n      sub: claims.sub,\n      email: claims.email,\n      username: claims['cognito:username'],\n      groups: claims['cognito:groups'] || [],\n    };\n  } catch (error) {\n    console.error('Error extracting user context:', error);\n    return null;\n  }\n}\n\n/**\n * Create success response\n */\nexport function successResponse<T>(data: T, message?: string): APIGatewayProxyResultV2 {\n  return {\n    statusCode: 200,\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      success: true,\n      message,\n      data,\n    } as ApiResponse<T>),\n  };\n}\n\n/**\n * Create error response\n */\nexport function errorResponse(\n  error: string,\n  code: string = 'INTERNAL_ERROR',\n  statusCode: number = 500\n): APIGatewayProxyResultV2 {\n  return {\n    statusCode,\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      success: false,\n      error,\n      code,\n    } as ApiResponse),\n  };\n}\n\n/**\n * Parse request body\n */\nexport function parseBody<T>(event: APIGatewayProxyEventV2): T | null {\n  try {\n    if (!event.body) {\n      return null;\n    }\n    return JSON.parse(event.body) as T;\n  } catch (error) {\n    console.error('Error parsing request body:', error);\n    return null;\n  }\n}\n\n/**\n * Validate required fields in request body\n */\nexport function validateRequired<T extends Record<string, any>>(\n  body: T | null,\n  requiredFields: (keyof T)[]\n): string | null {\n  if (!body) {\n    return 'Request body is required';\n  }\n\n  for (const field of requiredFields) {\n    if (body[field] === undefined || body[field] === null) {\n      return `Missing required field: ${String(field)}`;\n    }\n  }\n\n  return null;\n}\n"],
  "mappings": "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",
  "names": []
}
