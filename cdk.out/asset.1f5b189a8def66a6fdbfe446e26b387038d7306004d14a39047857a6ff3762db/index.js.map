{
  "version": 3,
  "sources": ["../../../lambda-functions/api-health/handler.ts"],
  "sourcesContent": ["/**\n * Health API Lambda Handler\n * Handles /api/health/* routes\n */\n\nimport { APIGatewayProxyEventV2, APIGatewayProxyResultV2 } from 'aws-lambda';\n\nexport const handler = async (\n  event: APIGatewayProxyEventV2\n): Promise<APIGatewayProxyResultV2> => {\n  const path = event.requestContext.http.path;\n  \n  console.log(`[Health API] ${event.requestContext.http.method} ${path}`);\n\n  try {\n    // S3 health check\n    if (path === '/api/health/s3') {\n      return await handleS3Health(event);\n    }\n\n    return {\n      statusCode: 404,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n      body: JSON.stringify({ error: 'Not found', path }),\n    };\n  } catch (error) {\n    console.error('[Health API] Error:', error);\n    return {\n      statusCode: 500,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n      body: JSON.stringify({\n        error: 'Internal server error',\n        message: error instanceof Error ? error.message : 'Unknown error',\n      }),\n    };\n  }\n};\n\nasync function handleS3Health(event: APIGatewayProxyEventV2): Promise<APIGatewayProxyResultV2> {\n  try {\n    const bucketName = process.env.STORAGE_BUCKET_NAME;\n    \n    if (!bucketName) {\n      return {\n        statusCode: 500,\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n        },\n        body: JSON.stringify({\n          status: 'unhealthy',\n          error: 'S3 bucket not configured',\n          timestamp: new Date().toISOString(),\n        }),\n      };\n    }\n\n    // Simple health check - just verify environment is configured\n    return {\n      statusCode: 200,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n        'Cache-Control': 'no-cache',\n      },\n      body: JSON.stringify({\n        status: 'healthy',\n        bucket: bucketName,\n        timestamp: new Date().toISOString(),\n      }),\n    };\n  } catch (error) {\n    return {\n      statusCode: 500,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n      body: JSON.stringify({\n        status: 'unhealthy',\n        error: error instanceof Error ? error.message : 'Unknown error',\n        timestamp: new Date().toISOString(),\n      }),\n    };\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAOO,IAAM,UAAU,OACrB,UACqC;AACrC,QAAM,OAAO,MAAM,eAAe,KAAK;AAEvC,UAAQ,IAAI,gBAAgB,MAAM,eAAe,KAAK,MAAM,IAAI,IAAI,EAAE;AAEtE,MAAI;AAEF,QAAI,SAAS,kBAAkB;AAC7B,aAAO,MAAM,eAAe,KAAK;AAAA,IACnC;AAEA,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU,EAAE,OAAO,aAAa,KAAK,CAAC;AAAA,IACnD;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,uBAAuB,KAAK;AAC1C,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO;AAAA,QACP,SAAS,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MACpD,CAAC;AAAA,IACH;AAAA,EACF;AACF;AAEA,eAAe,eAAe,OAAiE;AAC7F,MAAI;AACF,UAAM,aAAa,QAAQ,IAAI;AAE/B,QAAI,CAAC,YAAY;AACf,aAAO;AAAA,QACL,YAAY;AAAA,QACZ,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,+BAA+B;AAAA,QACjC;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACnB,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QACpC,CAAC;AAAA,MACH;AAAA,IACF;AAGA,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,QAC/B,iBAAiB;AAAA,MACnB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC,CAAC;AAAA,IACH;AAAA,EACF,SAAS,OAAO;AACd,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,QAAQ;AAAA,QACR,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,QAChD,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC,CAAC;AAAA,IACH;AAAA,EACF;AACF;",
  "names": []
}
