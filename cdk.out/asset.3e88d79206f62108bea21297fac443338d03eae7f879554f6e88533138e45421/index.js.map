{
  "version": 3,
  "sources": ["../../../lambda-functions/api-s3-proxy/handler.ts"],
  "sourcesContent": ["/**\n * S3 Proxy API Lambda Handler\n * Handles /api/s3-proxy route\n */\n\nimport { APIGatewayProxyEventV2, APIGatewayProxyResultV2 } from 'aws-lambda';\n\nexport const handler = async (\n  event: APIGatewayProxyEventV2\n): Promise<APIGatewayProxyResultV2> => {\n  console.log(`[S3 Proxy API] ${event.requestContext.http.method} ${event.requestContext.http.path}`);\n\n  try {\n    const queryParams = event.queryStringParameters || {};\n    const key = queryParams.key;\n\n    if (!key) {\n      return {\n        statusCode: 400,\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n        },\n        body: JSON.stringify({\n          error: 'Missing required parameter: key',\n        }),\n      };\n    }\n\n    const bucketName = process.env.STORAGE_BUCKET_NAME;\n    \n    if (!bucketName) {\n      return {\n        statusCode: 500,\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n        },\n        body: JSON.stringify({\n          error: 'S3 bucket not configured',\n        }),\n      };\n    }\n\n    // Return S3 URL for the object\n    // In a full implementation, this would fetch and proxy the S3 object\n    const s3Url = `https://${bucketName}.s3.amazonaws.com/${key}`;\n\n    return {\n      statusCode: 200,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n      body: JSON.stringify({\n        url: s3Url,\n        key,\n        bucket: bucketName,\n      }),\n    };\n  } catch (error) {\n    console.error('[S3 Proxy API] Error:', error);\n    return {\n      statusCode: 500,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n      body: JSON.stringify({\n        error: 'Internal server error',\n        message: error instanceof Error ? error.message : 'Unknown error',\n      }),\n    };\n  }\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAOO,IAAM,UAAU,OACrB,UACqC;AACrC,UAAQ,IAAI,kBAAkB,MAAM,eAAe,KAAK,MAAM,IAAI,MAAM,eAAe,KAAK,IAAI,EAAE;AAElG,MAAI;AACF,UAAM,cAAc,MAAM,yBAAyB,CAAC;AACpD,UAAM,MAAM,YAAY;AAExB,QAAI,CAAC,KAAK;AACR,aAAO;AAAA,QACL,YAAY;AAAA,QACZ,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,+BAA+B;AAAA,QACjC;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACnB,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAEA,UAAM,aAAa,QAAQ,IAAI;AAE/B,QAAI,CAAC,YAAY;AACf,aAAO;AAAA,QACL,YAAY;AAAA,QACZ,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,+BAA+B;AAAA,QACjC;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACnB,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAIA,UAAM,QAAQ,WAAW,UAAU,qBAAqB,GAAG;AAE3D,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,KAAK;AAAA,QACL;AAAA,QACA,QAAQ;AAAA,MACV,CAAC;AAAA,IACH;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,yBAAyB,KAAK;AAC5C,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO;AAAA,QACP,SAAS,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MACpD,CAAC;AAAA,IACH;AAAA,EACF;AACF;",
  "names": []
}
