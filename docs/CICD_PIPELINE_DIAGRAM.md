# CI/CD Pipeline Diagram

## GitHub Actions Workflow

```
┌─────────────────────────────────────────────────────────────────┐
│                         TRIGGER                                  │
│                                                                  │
│  Push to main branch  OR  Manual workflow dispatch              │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                      JOB 1: TEST                                 │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │   Checkout   │→ │   Install    │→ │  Run Linter  │         │
│  │     Code     │  │ Dependencies │  │              │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐                            │
│  │  Run Tests   │→ │    Build     │                            │
│  │              │  │   Frontend   │                            │
│  └──────────────┘  └──────────────┘                            │
│                                                                  │
│  Duration: ~2-3 minutes                                         │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                 JOB 2: DEPLOY BACKEND                            │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │   Checkout   │→ │  Configure   │→ │   Install    │         │
│  │     Code     │  │     AWS      │  │ Dependencies │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │  Build CDK   │→ │   CDK Diff   │→ │  CDK Deploy  │         │
│  │              │  │   (Preview)  │  │              │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                  │
│  ┌──────────────┐                                               │
│  │    Verify    │                                               │
│  │  Deployment  │                                               │
│  └──────────────┘                                               │
│                                                                  │
│  Duration: ~5-10 minutes                                        │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                 JOB 3: DEPLOY FRONTEND                           │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │   Checkout   │→ │  Configure   │→ │   Install    │         │
│  │     Code     │  │     AWS      │  │ Dependencies │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │    Build     │→ │  Get Bucket  │→ │  Deploy to   │         │
│  │   Frontend   │  │     Name     │  │      S3      │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐                            │
│  │  Invalidate  │→ │     Wait     │                            │
│  │  CloudFront  │  │  for Cache   │                            │
│  └──────────────┘  └──────────────┘                            │
│                                                                  │
│  Duration: ~3-5 minutes                                         │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                    JOB 4: VERIFY                                 │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │  Configure   │→ │    Verify    │→ │  Get URLs    │         │
│  │     AWS      │  │Stack Status  │  │              │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │     Test     │→ │     Test     │→ │  Deployment  │         │
│  │   Frontend   │  │   API Health │  │   Summary    │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                  │
│  Duration: ~1-2 minutes                                         │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
                    ┌────────────────┐
                    │   COMPLETE!    │
                    │                │
                    │  ✅ Backend    │
                    │  ✅ Frontend   │
                    │  ✅ Verified   │
                    └────────────────┘
```

---

## Deployment Flow

```
Developer                GitHub                 AWS
    │                      │                     │
    │  git push main       │                     │
    ├─────────────────────>│                     │
    │                      │                     │
    │                      │  Trigger Workflow   │
    │                      ├────────────────────>│
    │                      │                     │
    │                      │  Run Tests          │
    │                      │<────────────────────┤
    │                      │                     │
    │                      │  Deploy CDK         │
    │                      ├────────────────────>│
    │                      │                     │
    │                      │  Update Stack       │
    │                      │<────────────────────┤
    │                      │                     │
    │                      │  Deploy Frontend    │
    │                      ├────────────────────>│
    │                      │                     │
    │                      │  Upload to S3       │
    │                      │<────────────────────┤
    │                      │                     │
    │                      │  Invalidate CF      │
    │                      ├────────────────────>│
    │                      │                     │
    │                      │  Verify             │
    │                      │<────────────────────┤
    │                      │                     │
    │  Notification        │                     │
    │<─────────────────────┤                     │
    │                      │                     │
```

---

## AWS Resources Updated

```
┌─────────────────────────────────────────────────────────────────┐
│                    CDK STACK UPDATE                              │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                    Lambda Functions                       │  │
│  │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐           │  │
│  │  │  Chat  │ │Sessions│ │Renewable│ │Projects│  ... (17) │  │
│  │  └────────┘ └────────┘ └────────┘ └────────┘           │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                    API Gateway                            │  │
│  │  ┌────────────────────────────────────────────────────┐  │  │
│  │  │  Routes: /api/chat, /api/renewable, /api/projects  │  │  │
│  │  └────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                    DynamoDB Tables                        │  │
│  │  ┌────────────┐ ┌────────────┐                          │  │
│  │  │  Project   │ │ChatMessage │                          │  │
│  │  └────────────┘ └────────────┘                          │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                  FRONTEND DEPLOYMENT                             │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                         S3 Bucket                         │  │
│  │  ┌────────────────────────────────────────────────────┐  │  │
│  │  │  index.html, assets/, *.js, *.css, images/         │  │  │
│  │  └────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                    CloudFront CDN                         │  │
│  │  ┌────────────────────────────────────────────────────┐  │  │
│  │  │  Cache invalidated: /*                             │  │  │
│  │  │  New content served globally                       │  │  │
│  │  └────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Secrets Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                      GitHub Secrets                              │
│                                                                  │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────┐ │
│  │AWS_ACCESS_KEY_ID │  │AWS_SECRET_ACCESS │  │ VITE_API_URL │ │
│  │                  │  │      _KEY        │  │              │ │
│  └────────┬─────────┘  └────────┬─────────┘  └──────┬───────┘ │
│           │                     │                    │         │
└───────────┼─────────────────────┼────────────────────┼─────────┘
            │                     │                    │
            ▼                     ▼                    ▼
┌─────────────────────────────────────────────────────────────────┐
│                    GitHub Actions Runner                         │
│                                                                  │
│  Environment Variables:                                          │
│  - AWS_ACCESS_KEY_ID                                            │
│  - AWS_SECRET_ACCESS_KEY                                        │
│  - VITE_API_URL                                                 │
│                                                                  │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
                    ┌────────────────┐
                    │   AWS Account  │
                    │                │
                    │  Authenticated │
                    │    Actions     │
                    └────────────────┘
```

---

## Monitoring & Notifications

```
┌─────────────────────────────────────────────────────────────────┐
│                    GitHub Actions UI                             │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │  Workflow Runs                                            │  │
│  │  ┌────────────────────────────────────────────────────┐  │  │
│  │  │  ✅ Deploy to Production #42 - Success             │  │  │
│  │  │  ⏳ Deploy to Production #41 - In Progress         │  │  │
│  │  │  ❌ Deploy to Production #40 - Failed              │  │  │
│  │  └────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ├──────────────┐
                             │              │
                             ▼              ▼
                    ┌────────────┐  ┌────────────┐
                    │   Email    │  │   Slack    │
                    │Notification│  │Notification│
                    └────────────┘  └────────────┘
```

---

## Error Handling

```
┌─────────────────────────────────────────────────────────────────┐
│                      Error Scenarios                             │
│                                                                  │
│  Test Fails                                                      │
│  ├─> Stop pipeline                                              │
│  └─> Notify developer                                           │
│                                                                  │
│  CDK Deploy Fails                                               │
│  ├─> Automatic rollback                                         │
│  ├─> Stop pipeline                                              │
│  └─> Notify developer                                           │
│                                                                  │
│  Frontend Deploy Fails                                          │
│  ├─> Previous version remains                                   │
│  ├─> Stop pipeline                                              │
│  └─> Notify developer                                           │
│                                                                  │
│  Verification Fails                                             │
│  ├─> Deployment complete but flagged                            │
│  └─> Notify developer                                           │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Timeline Example

```
Time    Job                 Status      Details
────────────────────────────────────────────────────────────────
00:00   Trigger             ⏳          Push to main detected
00:01   Test                ⏳          Installing dependencies
00:02   Test                ⏳          Running linter
00:03   Test                ⏳          Running tests
00:04   Test                ⏳          Building frontend
00:05   Test                ✅          Complete
00:05   Deploy Backend      ⏳          Installing CDK dependencies
00:07   Deploy Backend      ⏳          Building CDK
00:08   Deploy Backend      ⏳          Running CDK diff
00:09   Deploy Backend      ⏳          Deploying stack
00:14   Deploy Backend      ✅          Complete
00:14   Deploy Frontend     ⏳          Building frontend
00:16   Deploy Frontend     ⏳          Uploading to S3
00:17   Deploy Frontend     ⏳          Invalidating CloudFront
00:19   Deploy Frontend     ✅          Complete
00:19   Verify              ⏳          Checking stack status
00:20   Verify              ⏳          Testing frontend
00:20   Verify              ⏳          Testing API
00:21   Verify              ✅          Complete
00:21   Pipeline            ✅          SUCCESS!
```

---

**Total Duration:** ~20 minutes  
**Success Rate:** Target 95%+  
**Cost per Deployment:** ~$0.01-0.02

---

**Last Updated:** November 16, 2025
